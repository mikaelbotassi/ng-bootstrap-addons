<app-sample-container tagName="nba-table">
  <nba-table #dt db-table id="table-sample"
    [multiple]="true"
    [value]="list()"
    [itemsPerPage]="2"
    [globalFilterFields]="['name', 'country.name', 'representative.name']"
    [(selectedRows)]="selectedRows"
    [columns]="[
      {field: 'id', header:'ID', visible: false, type:'numeric'},
      {field: 'name', header:'Nome', type:'text'},
      {field: 'country.name', header:'País', type:'text'},
      {field: 'representative.name', header:'Representante', type:'text'},
      {field: 'date', header:'Data', type:'date'},
      {field: 'verified', header:'Verificado', type:'boolean'}
    ]"
  >
    <ng-template #caption>
      @if(selectedRows().length > 0){
        <div class="d-flex align-items-center justify-content-end mt-3">
          <button type="button" class="btn btn-danger btn-sm" (click)="removeCustomer(selectedRows())">Excluir({{ selectedRows().length }})</button>
        </div>
      }
    </ng-template>
    <ng-template #header let-columns="columns">
      <tr>
        <th checkbox></th>
        <th width="2em"></th>
        @for(column of columns;track $index){
          @if(column.field == 'representative.name'){
            <th
              class="text-dark"
              nbaColumnHeader
              [field]="column.field"
              [filterPredicate]="filterByRepresentative"
            >
              {{ column.header }}
              <ng-template let-value let-setValue="setValue" #filter>
                  <nba-multiselect
                    inputClass="no-validate"
                    label="Representante"
                    [options]="representativeOptions"
                    [ngModel]="value"
                    (ngModelChange)="setValue($event)"
                    [multiple]="false"
                  ></nba-multiselect>
              </ng-template>
            </th>       
          }@else{
            <th class="text-dark" nbaColumnHeader [field]="column.field" [type]="column.type">{{column.header}}</th>
          }
        }
      </tr>
    </ng-template>

    <ng-template #body let-rows="rows" let-columns="columns">
      @for(row of rows; track $index){
      <tr nbaControl expandable (rowDoubleClick)="onDoubleClick()" [value]="row">
        @for(column of columns;track $index){
          @switch(column.field){
            @case('date'){
              <td>{{row[column.field] | date:'dd/MM/yyyy' }}</td>
            }
            @case('verified'){
              <td>{{row[column.field] ? 'Sim' : 'Não'}}</td>
            }
            @case('representative.name'){
              <td>
                  <div class="d-flex align-items-center gap-2">
                    <img [alt]="row.representative?.name" src="https://primefaces.org/cdn/primeng/images/demo/avatar/{{ row.representative?.image }}" width="32" style="vertical-align: middle" />
                    <span class="ml-1 align-middle">{{ row.representative?.name }}</span>
                  </div>
              </td>
            }
            @default{
              <td>{{row[column.field]}}</td>
            }
          }
        }
        <ng-container collapse>
          Teste
        </ng-container>
        <ng-container menu>
          <li role="menuitem">
            <a href="javascript:;" class="dropdown-item text-center">
            <i class="ti ti-printer"></i> Imprimir Relatório
          </a>
          </li>
          <li role="menuitem">
            <a href="javascript:;" class="dropdown-item text-center" (click)="removeCustomer(row)">
              <i class="ti ti-trash"></i> Remover
            </a>
          </li>
        </ng-container>
      </tr>
      }
    </ng-template>
  </nba-table>
</app-sample-container>
